<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1"><title>ストリーミングAPIの利用方法</title><!--*
*
* GitHub: https://github.com/joinmisskey
*
*--><link rel="canonical" href="https://join.misskey.page/en/wiki/developers/websocket"><link rel="alternate" hreflang="ja" href="https://join.misskey.page/ja/wiki/developers/websocket"><link rel="alternate" hreflang="en" href="https://join.misskey.page/en/wiki/developers/websocket"><link rel="alternate" hreflang="fr" href="https://join.misskey.page/fr/wiki/developers/websocket"><meta name="author" content="Misskey"><meta name="generator" content="maqz"><meta name="description" content="MisskeyのストリーミングAPIの利用方法について簡単に解説する。"><link rel="manifest" href="/manifest.json"><link rel="alternate" type="application/atom+xml" title="joinmisskey" href="https://join.misskey.page/feed.atom"><link rel="alternate" type="application/rss+xml" title="joinmisskey" href="https://join.misskey.page/feed.rss"><link rel="alternate" type="application/json" title="joinmisskey" href="https://join.misskey.page/feed.json"><script id="page_variables">var pathname = "/";
var currentLocale = "en";
var locales = ["ja","en","fr"];
var permalink = "/wiki/developers/websocket";
var gaId = "UA-121612835-1";
var jm_pathToWorker = "https://join.misskey.page/service_worker.js"
</script><script src="/assets/scripts/sw.js" async></script><script src="/assets/scripts/bootstrap.js" async></script><script src="/assets/scripts/main.js" async></script><script src="https://www.googletagmanager.com/gtag/js?id=UA-121612835-1" async></script><script data-ad-client="ca-pub-1736621122676736" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><link rel="preload" href="https://cdn.jsdelivr.net/gh/tamaina/The-Japanese-Web-Fonts@v7.2.0/dist/mplus-c/mplus-c-light.latain.woff2" as="font" crossorigin><link rel="preload" href="https://cdn.jsdelivr.net/gh/tamaina/The-Japanese-Web-Fonts@v7.2.0/dist/mplus-p/mplus-p-regular.latain.woff2" as="font" crossorigin><link rel="preload" href="https://cdn.jsdelivr.net/gh/tamaina/The-Japanese-Web-Fonts@v7.2.0/dist/mplus-p/mplus-p-bold.latain.woff2" as="font" crossorigin><link rel="preload" href="/assets/styles/fonts.css" as="style"><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.0/animate.min.css" as="style"><link rel="stylesheet" href="/assets/styles/main.css"><link rel="preload" href="https://twemoji.maxcdn.com/v/latest/twemoji.min.js" as="script"><link rel="icon" href="/favicon.ico" type="image/vnd.microsoft.icon"><link rel="apple-touch-icon" href="/files/images/icons/icon.svg?v=undefined" sizes="192x192"><link rel="icon" href="/files/images/icons/icon.svg?v=undefined" sizes="192x192" type="image/svg+xml"><link rel="apple-touch-icon" href="/files/images/icons/icon.png?v=undefined" sizes="700x700"><link rel="icon" href="/files/images/icons/icon.png?v=undefined" sizes="700x700" type="image/png"><meta name="theme-color" content="#105779"><meta property="og:type" content="website"><meta property="og:title" content="ストリーミングAPIの利用方法"><meta property="og:description" content="MisskeyのストリーミングAPIの利用方法について簡単に解説する。"><meta property="og:image" content="https://join.misskey.page/files/images/imports/2019/10/thumb.png?v=undefined"><meta property="og:url" content="https://join.misskey.page/en/wiki/developers/websocket"><meta property="og:site_name" content="Let's start Misskey"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://join.misskey.page/files/images/imports/2019/10/thumb.png?v=undefined"><meta name="twitter:title" content="ストリーミングAPIの利用方法"><meta name="twitter:description" content="MisskeyのストリーミングAPIの利用方法について簡単に解説する。"><meta name="twitter:site" content="misskey_io"></head><body><div id="nav"><nav class="navbar navbar-expand-md navbar-light flex-row p-0" id="mainnav"><button class="navbar-toggler" data-toggle="collapse" data-target="#navtoggle" aria-controls="navtoggle" aria-expanded="false" aria-label="Toggle navigation"><i class="fa fas bars" data-fa-prefix="fas" data-fa-icon-name="bars" data-fa-option="{}"></i></button><div class="collapse navbar-collapse" id="navtoggle"><ul class="navbar-nav mr-auto mt-lg-0 ml-3 ml-md-0"><li class="nav-item px-md-3"><a class="nav-link" href="/en/"><i class="fa fas home" data-fa-prefix="fas" data-fa-icon-name="home" data-fa-option="{'classes':['fa-fw']}"></i><span class="d-inline d-md-none d-lg-inline">&ensp;Home</span></a></li><li class="nav-item px-md-3"><a class="nav-link" href="/en/blog/"><i class="fa fas broadcast-tower" data-fa-prefix="fas" data-fa-icon-name="broadcast-tower" data-fa-option="{'classes':['fa-fw']}"></i><span class="d-inline d-md-none d-lg-inline">&ensp;Blog</span></a></li><li class="nav-item px-md-3 active"><a class="nav-link" href="/en/wiki/"><i class="fa fas book" data-fa-prefix="fas" data-fa-icon-name="book" data-fa-option="{'classes':['fa-fw']}"></i><span class="d-inline d-md-none d-lg-inline">&ensp;Wiki</span></a></li></ul><div class="input-group flex-nowrap" id="search"><input class="form-control" id="searchInput" type="search" placeholder="検索語句を入力" aria-label="Search"><div class="input-group-append flex-grow-0 flex-shrink-0"><button class="btn btn-primary" id="searchButton"><i class="fa fas search" data-fa-prefix="fas" data-fa-icon-name="search" data-fa-option="{'classes':['fa-fw']}"></i> Search</button></div></div></div><div class="dropleft"><button class="btn btn-outline-primary dropdown-toggle" type="button" id="locale_dropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">A文</button><div class="dropdown-menu m-2" aria-labelledby="locale_dropdown"><button class="nihongo dropdown-item" data-lang="ja">日本語</button><button class="nihongo dropdown-item" data-lang="en">English</button><button class="nihongo dropdown-item" data-lang="fr">Français</button></div></div></nav><nav class="bg-transparent" aria-label="breadcrumb" id="breadcrumb"><div class="container-fulid px-1 px-lg-5"><ol class="breadcrumb bg-transparent text-primary my-0 mx-md-5 mx-1 py-1 px-0"><li class="breadcrumb-item"><a class="py-1 text-primary" href="/en/"><i class="fa fas home" data-fa-prefix="fas" data-fa-icon-name="home" data-fa-option="{'classes':['fa-fw']}"></i><span class="sr-only">Home</span></a></li><li class="breadcrumb-item"><a class="py-1 text-primary" href="/en/wiki/">Wiki</a></li><li class="breadcrumb-item"><a class="py-1 text-primary" href="/en/wiki/developers/">開発者・運営者向け情報</a></li><li class="breadcrumb-item active"><a class="text-dark font-weight-bold trigger-gototop button-like-anchor" aria-current="page" href="https://join.misskey.page/en/wiki/developers/websocket">ストリーミングAPIの利用方法</a></li></ol></div></nav></div><div class="padding row" id="main"><div class="sade-outer d-none d-xl-block col-xl-3 order-1"><ins class="adsbygoogle p-0 sade d-none d-xl-block" style="display:block;" data-ad-client="ca-pub-1736621122676736" data-ad-slot="2773092095" data-ad-format="vertical" data-full-width-responsive="false"></ins></div><div class="p-0 col-12 px-xl-2 col-xl-9 order-0"><div class="container pt-5 pb-3 mb-2 bg-white main-shadow"><article class="bg-white" id="article_maincontent"><header class="w-100"><h1>ストリーミングAPIの利用方法</h1></header><div class="my-2 p-3 bg-light" id="article_sidenav"><details><summary class="font-weight-bold">目次</summary><ul class="list-unstyled ml-3 page-index m-0 p-0"><li><a href="#%E3%82%B9%E3%83%88%E3%83%AA%E3%83%BC%E3%83%A0%E3%81%AB%E6%8E%A5%E7%B6%9A%E3%81%99%E3%82%8B">ストリームに接続する</a></li><li><a href="#API%E3%83%AA%E3%82%AF%E3%82%A8%E3%82%B9%E3%83%88">APIリクエスト</a></li><li><a href="#%E3%83%81%E3%83%A3%E3%83%B3%E3%83%8D%E3%83%AB">チャンネル</a></li><ul class="list-unstyled ml-3 page-index"><li><a href="#%E3%83%81%E3%83%A3%E3%83%B3%E3%83%8D%E3%83%AB%E3%81%AB%E6%8E%A5%E7%B6%9A%E3%81%99%E3%82%8B">チャンネルに接続する</a></li><li><a href="#%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%81%AE%E5%8F%97%E4%BF%A1">イベントの受信</a></li><li><a href="#%E3%83%81%E3%83%A3%E3%83%B3%E3%83%8D%E3%83%AB%E3%81%8B%E3%82%89%E5%88%87%E6%96%AD%E3%81%99%E3%82%8B">チャンネルから切断する</a></li></ul><li><a href="#%E6%8A%95%E7%A8%BF%E3%81%AE%E3%82%AD%E3%83%A3%E3%83%97%E3%83%81%E3%83%A3">投稿のキャプチャ</a></li><ul class="list-unstyled ml-3 page-index"><li><a href="#%E3%82%AD%E3%83%A3%E3%83%97%E3%83%81%E3%83%A3%E3%81%99%E3%82%8B">キャプチャする</a></li><li><a href="#%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%81%AE%E5%8F%97%E4%BF%A1">イベントの受信</a></li><ul class="list-unstyled ml-3 page-index"><li><a href="#reacted%EF%BC%88%E3%83%AA%E3%82%A2%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%95%E3%82%8C%E3%81%9F%EF%BC%89"><code class="language-javascript">reacted</code>（リアクションされた）</a></li><li><a href="#unreacted%EF%BC%88%E3%83%AA%E3%82%A2%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%8C%E5%A4%96%E3%81%95%E3%82%8C%E3%81%9F%EF%BC%89"><code class="language-javascript">unreacted</code>（リアクションが外された）</a></li><li><a href="#deleted%EF%BC%88%E5%89%8A%E9%99%A4%E3%81%95%E3%82%8C%E3%81%9F%EF%BC%89"><code class="language-javascript">deleted</code>（削除された）</a></li><li><a href="#pollVoted%EF%BC%88%E6%8A%95%E7%A5%A8%E3%81%AB%E7%A5%A8%E3%81%8C%E5%85%A5%E3%81%A3%E3%81%9F%EF%BC%89"><code class="language-javascript">pollVoted</code>（投票に票が入った）</a></li></ul><li><a href="#%E3%82%AD%E3%83%A3%E3%83%97%E3%83%81%E3%83%A3%E3%82%92%E8%A7%A3%E9%99%A4%E3%81%99%E3%82%8B">キャプチャを解除する</a></li></ul></details></div><section class="pt-2 pb-4"><p>MisskeyのWebSocket通信によるストリーミングAPIでは、リアルタイムなイベントの受信や通常のAPI操作が行える。</p><p>WebSocket通信のテストには、Google Chrome拡張機能の<a href="https://chrome.google.com/webstore/detail/browser-websocket-client/mdmlhchldhfnfnkfmljgeinlffmdgkjo" target="_blank" rel="noopener">Browser WebSocket Client<i class="fa fas external-link-alt" data-fa-prefix="fas" data-fa-icon-name="external-link-alt" data-fa-option="{'classes':['fa-fw', 'fa-sm']}"></i></a>が便利である。</p><p><small><a href="https://misskey.io/docs/ja-JP/stream" target="_blank" rel="noopener">https://misskey.io/docs/ja-JP/stream</a></small></p><ins class="adsbygoogle my-4" style="display:block; text-align:left;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-1736621122676736" data-ad-slot="9247410221"></ins><h2 id="%E3%82%B9%E3%83%88%E3%83%AA%E3%83%BC%E3%83%A0%E3%81%AB%E6%8E%A5%E7%B6%9A%E3%81%99%E3%82%8B" class="blogstyle">ストリームに接続する</h2><p>WebSocket通信のエンドポイントは、misskey.ioなら次のとおりである。</p><p><code class="language-javascript">i</code>は自分のものに置き換えること。<a href="api"><code class="language-javascript">i</code>の取得方法についてはこちらを参照</a>。</p><pre class="language-javascript"><code class="language-pure">wss<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>misskey<span class="token punctuation">.</span>io<span class="token operator">/</span>streaming<span class="token operator">?</span>i<span class="token operator">=</span><span class="token number">1248</span>aBCDeFGH1632</code></pre><p>認証情報が必要ない操作のみ行う場合は、認証情報は不要だ。</p><pre class="language-javascript"><code class="language-pure">wss<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>misskey<span class="token punctuation">.</span>io<span class="token operator">/</span>streaming</code></pre><h2 id="API%E3%83%AA%E3%82%AF%E3%82%A8%E3%82%B9%E3%83%88" class="blogstyle">APIリクエスト</h2><p>まずは、ストリーミングAPIでノートの投稿をしてみよう。</p><pre class="language-javascript"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"api"</span><span class="token punctuation">,</span>
    <span class="token string">"body"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token string">"hoge"</span><span class="token punctuation">,</span>
        <span class="token string">"endpoint"</span><span class="token punctuation">:</span> <span class="token string">"notes/create"</span><span class="token punctuation">,</span>
        <span class="token string">"data"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"text"</span><span class="token punctuation">:</span> <span class="token string">"yee haw!"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><ul><li><code class="language-javascript">type</code>は<code class="language-javascript"><span class="token string">"api"</span></code>とする。</li><li><code class="language-javascript">body<span class="token punctuation">.</span>id</code>は、応答を区別できるようにするためのものだ。適当な文字列で構わない。</li><li><code class="language-javascript">body<span class="token punctuation">.</span>endpoint</code>でアクセスしたいエンドポイントを指定する。</li><li><code class="language-javascript">data</code>に送信するデータを指定する。</li></ul><p>上のJSONを送信し、投稿に成功すると、サーバーは以下のように返答してくる。</p><pre class="language-javascript"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"api:hoge"</span><span class="token punctuation">,</span>
  <span class="token string">"body"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">"res"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span> <span class="token comment">// 作成されたノートの情報</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><ul><li><code class="language-javascript">type</code>は<code class="language-javascript">api<span class="token punctuation">:</span><span class="token punctuation">(</span>送信時に指定したid<span class="token punctuation">)</span></code>となる。</li><li><code class="language-javascript">body<span class="token punctuation">.</span>res</code>に返り値が含まれる。</li></ul><h2 id="%E3%83%81%E3%83%A3%E3%83%B3%E3%83%8D%E3%83%AB" class="blogstyle">チャンネル</h2><p>チャンネルに接続することで、通知やタイムラインの更新を受け取ることができる。</p><h3 id="%E3%83%81%E3%83%A3%E3%83%B3%E3%83%8D%E3%83%AB%E3%81%AB%E6%8E%A5%E7%B6%9A%E3%81%99%E3%82%8B" class="blogstyle">チャンネルに接続する</h3><p>グローバルTLチャンネルに接続してみよう。</p><ins class="adsbygoogle my-4" style="display:block; text-align:left;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-1736621122676736" data-ad-slot="9247410221"></ins><pre class="language-javascript"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"connect"</span><span class="token punctuation">,</span>
  <span class="token string">"body"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">"channel"</span><span class="token punctuation">:</span> <span class="token string">"globalTimeline"</span><span class="token punctuation">,</span>
    <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token string">"global"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><ul><li><code class="language-javascript">type</code>は<code class="language-javascript"><span class="token string">"connect"</span></code>とする。</li><li><code class="language-javascript">body<span class="token punctuation">.</span>channel</code>に接続したいチャンネルを指定する。<br>チャンネルは以下の5つを指定できる。<ul><li><code class="language-javascript">main</code>（自分の通知）</li><li><code class="language-javascript">homeTimeline</code>（ホームTL）</li><li><code class="language-javascript">localTimeline</code>（ローカルTL）</li><li><code class="language-javascript">hybridTimeline</code>（ソーシャルTL）<br>ハイブリッドTLとはソーシャルTLの旧称である。</li><li><code class="language-javascript">globalTimeline</code>（グローバルTL）</li></ul></li><li><code class="language-javascript">body<span class="token punctuation">.</span>id</code>にはAPIリクエストと同じように適当な文字列を指定する。</li></ul><h3 id="%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%81%AE%E5%8F%97%E4%BF%A1" class="blogstyle">イベントの受信</h3><p>チャンネルに接続すると、イベントを受信するようになる。</p><pre class="language-javascript"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"channel"</span><span class="token punctuation">,</span>
  <span class="token string">"body"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token string">"global"</span><span class="token punctuation">,</span>
    <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"note"</span><span class="token punctuation">,</span>
    <span class="token string">"body"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span> <span class="token comment">// グローバルTLに流れてきたノートの情報</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><ul><li><code class="language-javascript">type</code>は<code class="language-javascript"><span class="token string">"channnel"</span></code>である。</li><li><code class="language-javascript">body<span class="token punctuation">.</span>id</code>は接続時に指定したidである。</li><li><code class="language-javascript">body<span class="token punctuation">.</span>type</code>はイベントの種類で、タイムラインチャンネルならば<code class="language-javascript">note</code>である。 mainチャンネルでは、以下のタイプが流れてくる。<ul><li><code class="language-javascript">renote</code>（リノート）</li><li><code class="language-javascript">mention</code>（メンション）</li><li><code class="language-javascript">readAllNotifications</code>（通知が全て既読になったことを示す）</li><li><code class="language-javascript">meUpdated</code>（自分の情報が更新された）</li><li><code class="language-javascript">follow</code>（フォローした）</li><li><code class="language-javascript">unfollow</code>（フォロー解除された）</li><li><code class="language-javascript">followed</code>（フォローされた）</li></ul></li><li><code class="language-javascript">body<span class="token punctuation">.</span>body</code>が内容である。上の例の場合はノートの内容である。</li></ul><h3 id="%E3%83%81%E3%83%A3%E3%83%B3%E3%83%8D%E3%83%AB%E3%81%8B%E3%82%89%E5%88%87%E6%96%AD%E3%81%99%E3%82%8B" class="blogstyle">チャンネルから切断する</h3><pre class="language-javascript"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"disconnect"</span><span class="token punctuation">,</span>
  <span class="token string">"body"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token string">"foobar"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><ul><li><code class="language-javascript">type</code>は<code class="language-javascript">disconnect</code>とする。</li><li><code class="language-javascript">body<span class="token punctuation">.</span>id</code>は接続時に指定したidとする。</li></ul><h2 id="%E6%8A%95%E7%A8%BF%E3%81%AE%E3%82%AD%E3%83%A3%E3%83%97%E3%83%81%E3%83%A3" class="blogstyle">投稿のキャプチャ</h2><p>投稿のリアクションや投票の状況、そして投稿が削除されたことをリアルタイムに取得できるよう、Misskeyでは投稿のキャプチャと呼ばれる仕組みを提供している。</p><h3 id="%E3%82%AD%E3%83%A3%E3%83%97%E3%83%81%E3%83%A3%E3%81%99%E3%82%8B" class="blogstyle">キャプチャする</h3><pre class="language-javascript"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"subNote"</span><span class="token punctuation">,</span>
    <span class="token string">"body"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token string">"800......."</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><ul><li><code class="language-javascript">type</code>は<code class="language-javascript"><span class="token string">"subNote"</span></code>とする。</li><li><code class="language-javascript">body<span class="token punctuation">.</span>id</code>はキャプチャしたい投稿のidとする。</li></ul><h3 id="%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%81%AE%E5%8F%97%E4%BF%A1" class="blogstyle">イベントの受信</h3><p>いづれのイベントも、</p><ul><li><code class="language-javascript">type</code>は<code class="language-javascript"><span class="token string">"noteUpdated"</span></code>である。</li><li><code class="language-javascript">body<span class="token punctuation">.</span>id</code>はイベントが発生した投稿のidである。</li><li><code class="language-javascript">body<span class="token punctuation">.</span>type</code>が発生したイベントのタイプである。</li></ul><ins class="adsbygoogle my-4" style="display:block; text-align:left;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-1736621122676736" data-ad-slot="9247410221"></ins><h4 id="reacted%EF%BC%88%E3%83%AA%E3%82%A2%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%95%E3%82%8C%E3%81%9F%EF%BC%89" class="blogstyle"><code class="language-javascript">reacted</code>（リアクションされた）</h4><pre class="language-javascript"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"noteUpdated"</span><span class="token punctuation">,</span>
    <span class="token string">"body"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token string">"800......."</span><span class="token punctuation">,</span>
        <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"reacted"</span><span class="token punctuation">,</span>
        <span class="token string">"body"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"reaction"</span><span class="token punctuation">:</span> <span class="token string">"like"</span><span class="token punctuation">,</span>
            <span class="token string">"userId"</span><span class="token punctuation">:</span> <span class="token string">"801......."</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><ul><li><code class="language-javascript">body<span class="token punctuation">.</span>body<span class="token punctuation">.</span>reaction</code>はリアクションの種類である。</li><li><code class="language-javascript">body<span class="token punctuation">.</span>body<span class="token punctuation">.</span>userId</code>はリアクションを付けたユーザーのidである。</li></ul><h4 id="unreacted%EF%BC%88%E3%83%AA%E3%82%A2%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%8C%E5%A4%96%E3%81%95%E3%82%8C%E3%81%9F%EF%BC%89" class="blogstyle"><code class="language-javascript">unreacted</code>（リアクションが外された）</h4><p>内容としては<code class="language-javascript">reacted</code>とほぼ同じであるので割愛。</p><h4 id="deleted%EF%BC%88%E5%89%8A%E9%99%A4%E3%81%95%E3%82%8C%E3%81%9F%EF%BC%89" class="blogstyle"><code class="language-javascript">deleted</code>（削除された）</h4><pre class="language-javascript"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"noteUpdated"</span><span class="token punctuation">,</span>
    <span class="token string">"body"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token string">"800......."</span><span class="token punctuation">,</span>
        <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"deleted"</span><span class="token punctuation">,</span>
        <span class="token string">"body"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"deletedAt"</span><span class="token punctuation">:</span> <span class="token string">"2018-10-22T02:17:09.703Z"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><ul><li><code class="language-javascript">body<span class="token punctuation">.</span>body<span class="token punctuation">.</span>deletedAt</code>として削除された日時が含まれる。</li></ul><h4 id="pollVoted%EF%BC%88%E6%8A%95%E7%A5%A8%E3%81%AB%E7%A5%A8%E3%81%8C%E5%85%A5%E3%81%A3%E3%81%9F%EF%BC%89" class="blogstyle"><code class="language-javascript">pollVoted</code>（投票に票が入った）</h4><pre class="language-javascript"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"noteUpdated"</span><span class="token punctuation">,</span>
    <span class="token string">"body"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token string">"800......."</span><span class="token punctuation">,</span>
        <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"deleted"</span><span class="token punctuation">,</span>
        <span class="token string">"body"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"choice"</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            <span class="token string">"userId"</span><span class="token punctuation">:</span> <span class="token string">"801......."</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><ul><li><code class="language-javascript">body<span class="token punctuation">.</span>body<span class="token punctuation">.</span>choice</code>は票が追加された選択肢の番号である。</li><li><code class="language-javascript">body<span class="token punctuation">.</span>body<span class="token punctuation">.</span>userId</code>は票を追加したユーザーのidである。</li></ul><h3 id="%E3%82%AD%E3%83%A3%E3%83%97%E3%83%81%E3%83%A3%E3%82%92%E8%A7%A3%E9%99%A4%E3%81%99%E3%82%8B" class="blogstyle">キャプチャを解除する</h3><pre class="language-javascript"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"unsubNote"</span><span class="token punctuation">,</span>
    <span class="token string">"body"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token string">"800......."</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><ul><li><code class="language-javascript">type</code>は<code class="language-javascript"><span class="token string">"unsubNote"</span></code>とする。</li><li><code class="language-javascript">body<span class="token punctuation">.</span>id</code>はキャプチャを解除したい投稿のidとする。</li></ul></section><footer class="w-100"><div class="d-flex flex-wrap my-2 bg-light"><a class="p-3 flex-fill" href="/en/wiki/developers/api" id="prev"><div class="container">Previous: APIの利用方法</div></a></div></footer></article><div class="small text-right mt-3"><a href="https://github.com/joinmisskey/joinmisskey.github.io/edit/pages/en/wiki/developers/websocket.md" target="_blank" rel="noopener"><i class="fa fas pencil-alt" data-fa-prefix="fas" data-fa-icon-name="pencil-alt" data-fa-option="{'classes':['fa-fw']}"></i>このページを編集</a></div></div></div><div class="py-3 col-12 px-0 w-100 order-2 text-center"><ins class="adsbygoogle container p-0" style="display:block;" data-ad-client="ca-pub-1736621122676736" data-ad-slot="4446014841" data-ad-format="auto" data-full-width-responsive="false"></ins></div></div><div class="bg-white mt-2" id="footer"><div class="py-3" id="footer_wrap"><div class="container"><div class="d-flex justify-content-between flex-wrap small"><div>© 2018-2019 Misskey</div><!--.
--><div class="text-muted" id="updateTime">Updated at Dec 7, 2019 6:45 PM JST</div><!--.
 
--><div><a href="https://github.com/syuilo/misskey" target="_blank" rel="noopener"><i class="fa fab github" data-fa-prefix="fab" data-fa-icon-name="github" data-fa-option="{'classes':['fa-fw']}"></i><span class="sr-only">GitHub</span>Misskey</a> <a href="https://github.com/joinmisskey/joinmisskey.github.io" target="_blank" rel="noopener"><i class="fa fab github" data-fa-prefix="fab" data-fa-icon-name="github" data-fa-option="{'classes':['fa-fw']}"></i><span class="sr-only">GitHub</span>joinmisskey</a> <a href="https://twitter.com/misskey_io" target="_blank" rel="noopener"><i class="fa fab twitter" data-fa-prefix="fab" data-fa-icon-name="twitter" data-fa-option="{'classes':['fa-fw']}"></i><span class="sr-only">Twitter</span></a> <a href="/feed.rss" target="_blank" rel="noopener"><i class="fa fas rss" data-fa-prefix="fas" data-fa-icon-name="rss" data-fa-option="{'classes':['fa-fw']}"></i><span>RSS</span></a> <a href="/feed.json" target="_blank" rel="noopener"><i class="fa fas rss" data-fa-prefix="fas" data-fa-icon-name="rss" data-fa-option="{'classes':['fa-fw']}"></i><span>JSON</span></a> <a href="/feed.atom" target="_blank" rel="noopener"><i class="fa fas rss" data-fa-prefix="fas" data-fa-icon-name="rss" data-fa-option="{'classes':['fa-fw']}"></i><span>Atom</span></a></div></div></div></div></div></body></html>